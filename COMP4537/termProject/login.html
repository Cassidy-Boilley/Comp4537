<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Login</title>
</head>

<body>
    <h2>User Login</h2>
    <form id="loginForm">
        <div>
            <label for="username">Username:</label>
            <input type="text" id="username" name="username" required>
        </div>
        <div>
            <label for="password">Password:</label>
            <input type="password" id="password" name="password" required>
        </div>
        <div>
            <button type="submit">Login</button>
        </div>
    </form>
</body>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('loginForm').addEventListener('submit', loginUser);
    });

    function loginUser(event) {
        event.preventDefault(); // Prevent the form from submitting normally
        const xhr = new XMLHttpRequest();
        xhr.withCredentials = true;

        // Fetch the form data
        const formData = new FormData(document.getElementById('loginForm'));
        const username = formData.get('username');
        const password = formData.get('password');

        // Send a POST request to the server to handle login
        xhr.open('POST', 'https://term-project4537.vercel.app/login', true);
        xhr.setRequestHeader('Content-Type', 'application/json');
        xhr.send(JSON.stringify({ username, password }));

        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4) {
                if (xhr.status === 200) {
                    const response = JSON.parse(xhr.responseText);
                    const role = response.role;
                    console.log('User role:', role);
                    // Redirect or perform actions based on the role
                    if (role === 'user') {
                        window.location.href = './user.html';
                    } else if (role === 'admin') {
                        window.location.href = './admin.html';
                    }
                } else {
                    console.error('Error logging in:', xhr.responseText);
                    // Handle error cases, such as displaying error messages to the user
                }
            }
        };
    }
</script>


</html>
